{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="main-menu">

    <div class="menu-header">
        <span class="menu-title">{{ page_title }}</span>
    </div>

    {% if error %}
    <div class="menu-row single">
        <div class="row-text" style="color: red;">{{ error }}</div>
    </div>
    {% endif %}

    {% if success %}
    <div class="menu-row single">
        <div class="row-text" style="color: green;">{{ success }}</div>
    </div>
    {% endif %}
    <div class="menu-row single">
        <a href="{% url 'main_menu' %}" class="menu-btn back full">‚¨Ö –í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</a>
    </div>

    {# ===================================================================== #}
    {# 1. –°–ü–ò–°–û–ö –ü–û–ó–ò–¶–ò–ô #}
    {# ===================================================================== #}
    {% if action == "list" or not action %}
        <div class="menu-row single">
            <a href="?action=add" class="menu-btn full">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é</a>
        </div>

        {% if positions %}
            {% for p in positions %}
            <div class="menu-row">
                <div class="row-text">
                    <b>{{ forloop.counter }}. {{ p.name }}</b> ‚Äî {{ p.price }} ‚ÇΩ
                </div>
                <div class="row-buttons">
                    <a href="?action=edit&index={{ forloop.counter0 }}" class="menu-btn">‚úèÔ∏è</a>
                    <a href="?action=delete&index={{ forloop.counter0 }}" class="menu-btn">üóë</a>
                </div>
            </div>
            {% endfor %}
        {% else %}
        <div class="menu-row single">
            <div class="row-text">–ü–æ–∑–∏—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç.</div>
        </div>
        {% endif %}
    {% endif %}


    {# ===================================================================== #}
    {# 2. –î–û–ë–ê–í–õ–ï–ù–ò–ï –ü–û–ó–ò–¶–ò–ò #}
    {# ===================================================================== #}
    {% if action == "add" %}
        {% if not action_done %}
        <form method="POST">
            {% csrf_token %}

            <div class="menu-row single">
                <div class="row-text">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                    <input type="text" name="name" class="input full" required>
                </div>
            </div>

            <div class="menu-row single">
                <div class="row-text">
                    <label>–¶–µ–Ω–∞ (‚ÇΩ):</label>
                    <input type="number" step="0.01" name="price" class="input full" required>
                </div>
            </div>

            <div class="menu-row single">
                <button class="menu-btn full">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
        </form>
        {% endif %}

        <div class="menu-row single">
            <a href="?action=list" class="menu-btn back full">‚¨Ö –ù–∞–∑–∞–¥</a>
        </div>
    {% endif %}


    {# ===================================================================== #}
    {# 3. –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï #}
    {# ===================================================================== #}
    {% if action == "edit" %}
        {% if not action_done %}
        <form method="POST">
            {% csrf_token %}

            <div class="menu-row single">
                <div class="row-text">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                    <input type="text" name="name" class="input full" value="{{ edit_position.name }}" required>
                </div>
            </div>

            <div class="menu-row single">
                <div class="row-text">
                    <label>–¶–µ–Ω–∞ (‚ÇΩ):</label>
                    <input type="number" step="0.01" name="price" class="input full"
                           value="{{ edit_position.price }}" required>
                </div>
            </div>

            <div class="menu-row single">
                <button class="menu-btn full">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </form>
        {% endif %}

        <div class="menu-row single">
            <a href="?action=list" class="menu-btn back full">‚¨Ö –ù–∞–∑–∞–¥</a>
        </div>
    {% endif %}


    {# ===================================================================== #}
    {# 4. –£–î–ê–õ–ï–ù–ò–ï #}
    {# ===================================================================== #}
    {% if action == "delete" %}
        {% if not action_done %}
        <div class="menu-row single">
            <div class="row-text">
                –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é
                <b>"{{ delete_position.name }}"</b>?
            </div>
        </div>

        <form method="POST">
            {% csrf_token %}
            <div class="menu-row">
                <button class="menu-btn full" style="background: red;">–î–∞, —É–¥–∞–ª–∏—Ç—å</button>
            </div>
        </form>
        {% endif %}

        <div class="menu-row single">
            <a href="?action=list" class="menu-btn back full">‚¨Ö –ù–∞–∑–∞–¥</a>
        </div>
    {% endif %}




</div>
{% endblock %}
